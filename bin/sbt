#!/bin/sh

unset SBT_OPTS
unset JAVA_OPTS

# -Dcom.sun.management.jmxremote=true \
# -Dcom.sun.management.jmxremote.ssl=false \
# -Dcom.sun.management.jmxremote.authenticate=false \

export JAVA_TOOL_OPTIONS="-Dfile.encoding=UTF8"
if [ "$(uname)" = "Darwin" ]; then
  export JAVA_HOME="/usr/libexec/java_home --version 1.7"
fi

exec java \
-d64 \
-Xms3g \
-Xmx3g \
-XX:+DoEscapeAnalysis \
-XX:+UseCompressedOops \
-XX:MaxPermSize=1200m \
-XX:+CMSClassUnloadingEnabled \
-XX:+AggressiveOpts \
-XX:+UseFastAccessorMethods \
-XX:+UseStringCache \
-XX:+OptimizeStringConcat \
-XX:+UseBiasedLocking \
-Djna.library.path=$(pwd)/lib \
-Dfile.encoding=UTF-8 \
-Djava.net.preferIPv4Stack=true \
-server \
-javaagent:/lib/jrebel/jrebel.jar \
-jar $(dirname $0)/../vendor/sbt-launch.jar "$@"
